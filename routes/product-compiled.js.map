{"version":3,"sources":["product.js"],"names":[],"mappings":";;AAAA;;;;AACA;;AACA;;;;AAEA,IAAM,SAAS,kBAAQ,MAAR,EAAf;;AAEA,OAAO,GAAP,CAAW,QAAX,EAAqB,UAAC,GAAD,EAAM,GAAN,EAAc;AACjC,iBAAK,aAAL,CAAmB,UAAC,GAAD,EAAM,UAAN,EAAqB;AACtC,QAAI,GAAJ,EAAS;AACP,UAAM,MAAM,4DAAZ;;AAEA,cAAQ,GAAR,CAAY,GAAZ;AACA,cAAQ,GAAR,CAAY,GAAZ;AACA,UAAI,IAAJ,CAAS,EAAC,QAAD,EAAM,QAAN,EAAT;AACD,KAND,MAMO;AACL,UAAM,wEAGQ,IAAI,KAAJ,CAAU,SAHlB,wCAAN;;AAMA,0CAAe,UAAf,EAA2B,KAA3B,EAAkC,IAAlC,CAAuC,mBAAW;AAChD,YAAM,eAAe,QAAQ,MAAR,GAAiB,CAAtC;AACA,mBAAW,OAAX;AACA,YAAI,IAAJ,CAAS,EAAC,0BAAD,EAAT;AACD,OAJD;AAKD;AACF,GApBD;AAqBD,CAtBD,EAuBC,GAvBD,CAuBK,GAvBL,EAuBU,UAAC,GAAD,EAAM,GAAN,EAAW,IAAX,EAAoB;AAC5B,iBAAK,aAAL,CAAmB,UAAC,GAAD,EAAM,UAAN,EAAqB;AACtC,QAAI,GAAJ,EAAS,MAAM,GAAN;;AAET,QAAI,OAAJ,CAAY,UAAC,OAAD,EAAU,MAAV,EAAqB;AAC/B,UAAM,uEAGW,IAAI,KAAJ,CAAU,SAH3B;;AAKA,0CAAe,UAAf,EAA2B,KAA3B,EACG,IADH,CACQ,mBAAW;AACf,YAAM,UAAU,QAAQ,CAAR,CAAhB;;AAEA,gBAAQ,OAAR;AACD,OALH;AAMD,KAZD,EAYG,IAZH,CAYQ,UAAC,OAAD,EAAa;AACnB,UAAM,oFAGmB,IAAI,KAAJ,CAAU,SAHnC;;AAKA,aAAO,oCAAe,UAAf,EAA2B,KAA3B,EACJ,IADI,CACC,mBAAW;AACf,gBAAQ,SAAR,IAAqB,OAArB;;AAEA,eAAO,OAAP;AACD,OALI,CAAP;AAMD,KAxBD,EAwBG,IAxBH,CAwBQ,UAAC,OAAD,EAAa;AACnB,UAAM,qFAGmB,IAAI,KAAJ,CAAU,SAHnC;;AAKA,aAAO,oCAAe,UAAf,EAA2B,KAA3B,EACJ,IADI,CACC,mBAAW;AACf,gBAAQ,SAAR,IAAqB,OAArB;;AAEA,eAAO,OAAP;AACD,OALI,CAAP;AAMD,KApCD,EAoCG,IApCH,CAoCQ,UAAC,OAAD,EAAa;AACnB;AACA,UAAM,iFAGmB,IAAI,KAAJ,CAAU,SAHnC;;AAKA,0CAAe,UAAf,EAA2B,KAA3B,EACG,IADH,CACQ,mBAAW;AACf,gBAAQ,aAAR,IAAyB,OAAzB;;AAEA,YAAI,IAAJ,CAAS,EAAC,gBAAD,EAAT;AACA,mBAAW,OAAX;AACD,OANH;AAOD,KAlDD;AAmDD,GAtDD;AAuDD,CA/ED;;AAiFA,OAAO,OAAP,GAAiB,MAAjB","file":"product-compiled.js","sourcesContent":["import express from 'express';\r\nimport { pool } from './DBconfig';\r\nimport { queryConductor } from './queryConductor';\r\n\r\nconst router = express.Router();\r\n\r\nrouter.get(\"/check\", (req, res) => {\r\n  pool.getConnection((err, connection) => {\r\n    if (err) {\r\n      const msg = \"Error occurs while pool.getConnection # GET /product/check\";\r\n\r\n      console.log(err);\r\n      console.log(msg);\r\n      res.json({err, msg});\r\n    } else {\r\n      const query = `\r\n      SELECT id\r\n        FROM product\r\n       WHERE id = ${req.query.productId}\r\n         AND unusable_flag = NULL`;\r\n\r\n      queryConductor(connection, query).then(results => {\r\n        const productCheck = results.length > 0;\r\n        connection.release();\r\n        res.json({productCheck});\r\n      })\r\n    }\r\n  })\r\n})\r\n.get(\"/\", (req, res, next) => {\r\n  pool.getConnection((err, connection) => {\r\n    if (err) throw err;\r\n\r\n    new Promise((resolve, reject) => {\r\n      const query =\r\n        `SELECT * \r\n           FROM product \r\n          WHERE id = ${req.query.productId}`;\r\n\r\n      queryConductor(connection, query)\r\n        .then(results => {\r\n          const product = results[0];\r\n\r\n          resolve(product);\r\n        });\r\n    }).then((product) => {\r\n      const query =\r\n        `SELECT *\r\n           FROM product_option\r\n          WHERE product_id = ${req.query.productId}`;\r\n\r\n      return queryConductor(connection, query)\r\n        .then(results => {\r\n          product[\"options\"] = results;\r\n\r\n          return product;\r\n        });\r\n    }).then((product) => {\r\n      const query =\r\n        `SELECT * \r\n           FROM product_detail\r\n          WHERE product_id = ${req.query.productId}`;\r\n\r\n      return queryConductor(connection, query)\r\n        .then(results => {\r\n          product[\"details\"] = results;\r\n\r\n          return product;\r\n        })\r\n    }).then((product) => {\r\n      // 이거 페이지 기능 넣어서 쿼리 수정해야해\r\n      const query = \r\n        `SELECT *\r\n           FROM post_script\r\n          WHERE product_id = ${req.query.productId}`;\r\n\r\n      queryConductor(connection, query)\r\n        .then(results => {\r\n          product[\"post_script\"] = results;\r\n\r\n          res.json({product});\r\n          connection.release();\r\n        })\r\n    });\r\n  })\r\n});\r\n\r\nmodule.exports = router;"]}